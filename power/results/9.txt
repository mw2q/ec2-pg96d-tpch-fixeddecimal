BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2750861825.31077
 ALGERIA                   |   1997 | 4693575226.31416
 ALGERIA                   |   1996 | 4722287156.83918
 ALGERIA                   |   1995 | 4695449945.29503
 ALGERIA                   |   1994 | 4692997613.75421
 ALGERIA                   |   1993 | 4663520196.66326
 ALGERIA                   |   1992 | 4710301641.37339
 ARGENTINA                 |   1998 | 2747193776.17036
 ARGENTINA                 |   1997 | 4681097366.56191
 ARGENTINA                 |   1996 | 4697285428.30766
 ARGENTINA                 |   1995 | 4654146152.61814
 ARGENTINA                 |   1994 | 4677659766.59378
 ARGENTINA                 |   1993 | 4655738786.02173
 ARGENTINA                 |   1992 | 4673339273.30073
 BRAZIL                    |   1998 | 2740218819.82861
 BRAZIL                    |   1997 | 4663514001.42808
 BRAZIL                    |   1996 | 4690548523.30061
 BRAZIL                    |   1995 | 4686209842.80497
 BRAZIL                    |   1994 |  4659888147.1043
 BRAZIL                    |   1993 | 4680320478.80179
 BRAZIL                    |   1992 |  4706957157.3929
 CANADA                    |   1998 | 2735842463.42679
 CANADA                    |   1997 | 4668215549.83061
 CANADA                    |   1996 | 4708697539.59025
 CANADA                    |   1995 | 4670454427.89892
 CANADA                    |   1994 |  4678843767.4183
 CANADA                    |   1993 | 4662042328.41002
 CANADA                    |   1992 | 4682811492.46295
 CHINA                     |   1998 | 2747023705.39361
 CHINA                     |   1997 | 4693450440.39851
 CHINA                     |   1996 | 4680354754.23629
 CHINA                     |   1995 | 4668370059.76475
 CHINA                     |   1994 | 4686876989.61631
 CHINA                     |   1993 | 4679258717.21484
 CHINA                     |   1992 | 4687785951.93495
 EGYPT                     |   1998 | 2747451298.07981
 EGYPT                     |   1997 | 4680058749.33788
 EGYPT                     |   1996 | 4683491777.29764
 EGYPT                     |   1995 | 4682031589.61046
 EGYPT                     |   1994 | 4683483693.28738
 EGYPT                     |   1993 | 4688923836.02187
 EGYPT                     |   1992 | 4700263281.69343
 ETHIOPIA                  |   1998 | 2782397563.84648
 ETHIOPIA                  |   1997 | 4699616001.32604
 ETHIOPIA                  |   1996 | 4723958346.25367
 ETHIOPIA                  |   1995 | 4717293699.26505
 ETHIOPIA                  |   1994 | 4740169686.75783
 ETHIOPIA                  |   1993 | 4713720801.95038
 ETHIOPIA                  |   1992 | 4726126962.85631
 FRANCE                    |   1998 |  2753678502.0455
 FRANCE                    |   1997 |  4689207757.0378
 FRANCE                    |   1996 | 4692479934.54106
 FRANCE                    |   1995 | 4674374371.44703
 FRANCE                    |   1994 | 4673151889.86983
 FRANCE                    |   1993 | 4659438351.72102
 FRANCE                    |   1992 | 4695785964.84913
 GERMANY                   |   1998 |  2751453162.0893
 GERMANY                   |   1997 |  4663267520.7234
 GERMANY                   |   1996 |  4672456967.9955
 GERMANY                   |   1995 | 4672164044.51101
 GERMANY                   |   1994 | 4689897738.54108
 GERMANY                   |   1993 | 4669640308.47302
 GERMANY                   |   1992 |  4688792733.4826
 INDIA                     |   1998 | 2765065131.66435
 INDIA                     |   1997 | 4712439384.33667
 INDIA                     |   1996 | 4686471468.48235
 INDIA                     |   1995 | 4685708291.16328
 INDIA                     |   1994 | 4676870851.67483
 INDIA                     |   1993 |  4662867950.3381
 INDIA                     |   1992 | 4708147527.61857
 INDONESIA                 |   1998 | 2717273387.77394
 INDONESIA                 |   1997 | 4621671957.84871
 INDONESIA                 |   1996 | 4629537000.75526
 INDONESIA                 |   1995 |  4620677679.6896
 INDONESIA                 |   1994 | 4627392134.26423
 INDONESIA                 |   1993 | 4624060376.21954
 INDONESIA                 |   1992 | 4648550782.69875
 IRAN                      |   1998 |  2738311029.0247
 IRAN                      |   1997 |  4650508566.4237
 IRAN                      |   1996 |  4676223171.4315
 IRAN                      |   1995 | 4660469678.37939
 IRAN                      |   1994 | 4660711086.81682
 IRAN                      |   1993 | 4645826701.46672
 IRAN                      |   1992 | 4674145922.18458
 IRAQ                      |   1998 | 2728546107.77611
 IRAQ                      |   1997 | 4661027423.49056
 IRAQ                      |   1996 | 4676489029.15049
 IRAQ                      |   1995 | 4665737803.60304
 IRAQ                      |   1994 | 4652368640.14527
 IRAQ                      |   1993 |  4663187256.9238
 IRAQ                      |   1992 | 4690320190.79301
 JAPAN                     |   1998 |   2720163505.799
 JAPAN                     |   1997 | 4677594141.93091
 JAPAN                     |   1996 | 4656740257.07408
 JAPAN                     |   1995 | 4638873532.40912
 JAPAN                     |   1994 | 4657569839.98562
 JAPAN                     |   1993 | 4638964914.56517
 JAPAN                     |   1992 | 4648991812.86142
 JORDAN                    |   1998 | 2741352512.43897
 JORDAN                    |   1997 | 4682996312.16778
 JORDAN                    |   1996 | 4682356654.41541
 JORDAN                    |   1995 | 4669806430.57346
 JORDAN                    |   1994 | 4675375373.69266
 JORDAN                    |   1993 | 4670801509.69797
 JORDAN                    |   1992 | 4699944080.10655
 KENYA                     |   1998 | 2703789456.27181
 KENYA                     |   1997 | 4621676976.26218
 KENYA                     |   1996 | 4660753179.54241
 KENYA                     |   1995 | 4626856831.44175
 KENYA                     |   1994 | 4655168959.59002
 KENYA                     |   1993 | 4666682801.16752
 KENYA                     |   1992 | 4658243775.60847
 MOROCCO                   |   1998 |  2727181482.6445
 MOROCCO                   |   1997 | 4670074863.65804
 MOROCCO                   |   1996 | 4686118774.84343
 MOROCCO                   |   1995 |  4655542874.2217
 MOROCCO                   |   1994 | 4661341699.56742
 MOROCCO                   |   1993 | 4655983517.76741
 MOROCCO                   |   1992 | 4689825722.31842
 MOZAMBIQUE                |   1998 |  2749784047.0921
 MOZAMBIQUE                |   1997 | 4702627626.60304
 MOZAMBIQUE                |   1996 | 4694577418.22412
 MOZAMBIQUE                |   1995 | 4641099401.23781
 MOZAMBIQUE                |   1994 | 4679103649.47328
 MOZAMBIQUE                |   1993 | 4665565439.01247
 MOZAMBIQUE                |   1992 | 4668134983.49975
 PERU                      |   1998 | 2702222656.66301
 PERU                      |   1997 | 4625025055.50528
 PERU                      |   1996 | 4622289236.14366
 PERU                      |   1995 |  4607939528.8391
 PERU                      |   1994 | 4604143366.65535
 PERU                      |   1993 | 4636205888.07256
 PERU                      |   1992 | 4613824146.26773
 ROMANIA                   |   1998 | 2733888339.22954
 ROMANIA                   |   1997 | 4668048829.91331
 ROMANIA                   |   1996 | 4659683100.09645
 ROMANIA                   |   1995 | 4672026278.63318
 ROMANIA                   |   1994 | 4695288273.23872
 ROMANIA                   |   1993 | 4659340690.30611
 ROMANIA                   |   1992 | 4706322757.74329
 RUSSIA                    |   1998 | 2714139231.13488
 RUSSIA                    |   1997 | 4650816433.46335
 RUSSIA                    |   1996 | 4676906940.33077
 RUSSIA                    |   1995 | 4651920425.29548
 RUSSIA                    |   1994 | 4678475721.76443
 RUSSIA                    |   1993 |  4658292044.8659
 RUSSIA                    |   1992 | 4679263805.19837
 SAUDI ARABIA              |   1998 | 2728001313.12251
 SAUDI ARABIA              |   1997 | 4646938461.59381
 SAUDI ARABIA              |   1996 | 4666583191.63055
 SAUDI ARABIA              |   1995 | 4662994766.38553
 SAUDI ARABIA              |   1994 |  4669512354.5294
 SAUDI ARABIA              |   1993 | 4654061825.98098
 SAUDI ARABIA              |   1992 | 4649799261.92385
 UNITED KINGDOM            |   1998 |   2771522168.946
 UNITED KINGDOM            |   1997 | 4694458227.25856
 UNITED KINGDOM            |   1996 | 4724217807.96962
 UNITED KINGDOM            |   1995 |  4676480531.9157
 UNITED KINGDOM            |   1994 | 4718715311.60534
 UNITED KINGDOM            |   1993 | 4706187714.77101
 UNITED KINGDOM            |   1992 | 4721503215.53231
 UNITED STATES             |   1998 | 2736745459.08093
 UNITED STATES             |   1997 | 4669841734.29222
 UNITED STATES             |   1996 | 4702113020.44375
 UNITED STATES             |   1995 |  4685418669.0408
 UNITED STATES             |   1994 | 4677654411.30727
 UNITED STATES             |   1993 | 4673976989.69984
 UNITED STATES             |   1992 | 4680254702.25151
 VIETNAM                   |   1998 | 2742078043.71498
 VIETNAM                   |   1997 | 4686517475.50642
 VIETNAM                   |   1996 | 4702520285.98903
 VIETNAM                   |   1995 | 4707042879.27646
 VIETNAM                   |   1994 | 4689038840.68469
 VIETNAM                   |   1993 | 4677812937.66352
 VIETNAM                   |   1992 | 4685685066.25731
(175 rows)

COMMIT;
COMMIT
